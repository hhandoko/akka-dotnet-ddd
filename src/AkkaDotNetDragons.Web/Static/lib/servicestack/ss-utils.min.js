(function(a){if(!a.ss){a.ss={}}a.ss.handlers={};a.ss.onSubmitDisable="[type=submit]";a.ss.validation={overrideMessages:false,messages:{NotEmpty:"Required",NotNull:"Required",Email:"Invalid email",AlreadyExists:"Already exists"},errorFilter:function(g,f,h){return this.overrideMessages?this.messages[f]||g||d(f):g||d(f)}};a.ss.clearAdjacentError=function(){a(this).removeClass("error");a(this).prev(".help-inline,.help-block").removeClass("error").html("");a(this).next(".help-inline,.help-block").removeClass("error").html("")};a.ss.todate=function(f){return new Date(parseFloat(/Date\(([^)]+)\)/.exec(f)[1]))};a.ss.todfmt=function(f){return a.ss.dfmt(a.ss.todate(f))};function b(f){return f<10?"0"+f:f}a.ss.dfmt=function(f){return f.getFullYear()+"/"+b(f.getMonth()+1)+"/"+b(f.getDate())};a.ss.dfmthm=function(f){return f.getFullYear()+"/"+b(f.getMonth()+1)+"/"+b(f.getDate())+" "+b(f.getHours())+":"+b(f.getMinutes())};a.ss.tfmt12=function(f){return b(f.getHours())+":"+b(f.getMinutes())+":"+b(f.getSeconds())+" "+(f.getHours()>12?"PM":"AM")};a.ss.splitOnFirst=function(h,f){if(!h){return[h]}var g=h.indexOf(f);return g>=0?[h.substring(0,g),h.substring(g+1)]:[h]};a.ss.splitOnLast=function(h,f){if(!h){return[h]}var g=h.lastIndexOf(f);return g>=0?[h.substring(0,g),h.substring(g+1)]:[h]};a.ss.getSelection=function(){return window.getSelection?window.getSelection().toString():document.selection&&document.selection.type!="Control"?document.selection.createRange().text:""};a.ss.queryString=function(k){if(!k){return{}}var j=a.ss.splitOnFirst(k,"?")[1].split("&");var g={};for(var f=0;f<j.length;++f){var h=j[f].split("=");g[h[0]]=h.length>1?decodeURIComponent(h[1].replace(/\+/g," ")):null}return g};a.ss.createUrl=function(o,g){if(!g){g={}}var f={};for(var j in g){f[j.toLowerCase()]=j}var n=o.split("/");var q="";for(var h=0;h<n.length;h++){var m=n[h];if(m==null){m=""}if(m[0]=="{"&&m[m.length-1]=="}"){var l=f[m.substring(1,m.length-1).toLowerCase()];if(l){m=g[l];delete g[l]}}if(q.length>0){q+="/"}q+=m}return q};function d(f){return typeof f!="string"?f:f.replace(/([A-Z]|[0-9]+)/g," $1").replace(/_/g," ")}a.ss.humanize=function(f){return !f||f.indexOf(" ")>=0?f:d(f)};function e(f){return !f?f:f.charAt(0).toLowerCase()+f.substring(1)}function c(g){if(g.errors){return g}var h={};for(var f in g){h[e(f)]=g[f]}h.errors=[];a.each(g.Errors||[],function(l,n){var j={};for(var m in n){j[e(m)]=n[m]}h.errors.push(j)});return h}a.fn.setFieldError=function(g,f){a(this).applyErrors({errors:[{fieldName:g,message:f}]})};a.fn.serializeMap=function(){var f={};a.each(a(this).serializeArray(),function(h,g){f[g.name]=g.value});return f};a.fn.applyErrors=function(l,k){this.clearErrors();if(!l){return this}l=c(l);this.addClass("has-errors");var j=a.extend({},a.ss.validation,k);if(k&&k.messages){j.overrideMessages=true;a.extend(j.messages,a.ss.validation.messages)}var i=a.proxy(j.errorFilter,j),f=l.errors;if(f&&f.length){var h={},g={};this.find("input,textarea,select,button").each(function(){var m=a(this);var o=m.prev(),n=m.next();var p=this.id||m.attr("name");if(!p){return}var q=(p).toLowerCase();h[q]=m;if(o.hasClass("help-inline")||o.hasClass("help-block")){g[q]=o}else{if(n.hasClass("help-inline")||n.hasClass("help-block")){g[q]=n}}});this.find(".help-inline[data-for],.help-block[data-for]").each(function(){var m=a(this);var n=m.data("for").toLowerCase();g[n]=m});a.each(f,function(p,o){var q=(o.fieldName||"").toLowerCase();var m=h[q];if(m){m.addClass("error");m.parent().addClass("has-error")}var n=g[q];if(!n){return}n.addClass("error");n.html(i(o.message,o.errorCode,"field"));n.show()})}else{this.find(".error-summary").html(i(l.message||d(l.errorCode),l.errorCode,"summary")).show()}return this};a.fn.clearErrors=function(){this.removeClass("has-errors");this.find(".error-summary").html("").hide();this.find(".help-inline.error, .help-block.error").each(function(){a(this).html("")});this.find(".error").each(function(){a(this).removeClass("error")});return this.find(".has-error").each(function(){a(this).removeClass("has-error")})};a.fn.bindForm=function(f){return this.each(function(){f=f||{};if(f.validation){a.extend(a.ss.validation,f.validation)}var g=a(this);g.submit(function(i){i.preventDefault();g.clearErrors();try{if(f.validate&&f.validate.call(g)===false){return false}}catch(i){return false}g.addClass("loading");var h=a(f.onSubmitDisable||a.ss.onSubmitDisable,g);h.attr("disabled","disabled");var j=a.extend({},f,{type:g.attr("method")||"POST",url:g.attr("action"),data:g.serialize(),accept:"application/json",error:function(n,o,p){var l,m="The request failed with "+p;try{l=JSON.parse(n.responseText)}catch(k){}if(!l){g.addClass("has-errors");g.find(".error-summary").html(m)}else{g.applyErrors(l.ResponseStatus||l.responseStatus)}if(f.error){f.error.apply(this,arguments)}},complete:function(n){g.removeClass("loading");h.removeAttr("disabled");if(f.complete){f.complete.apply(this,arguments)}var o=n.getResponseHeader("X-Location");if(o){location.href=o}var m=n.getResponseHeader("X-Trigger");if(m){var p=attr.indexOf(":");var k=p>=0?m.substring(0,p):m;var l=p>=0?m.substring(p+1):null;g.trigger(k,l?[l]:[])}},dataType:"json",});a.ajax(j);return false})})};a.fn.applyValues=function(f){return this.each(function(){var g=a(this);a.each(f,function(h,i){g.find("#"+h+",[name="+h+"]").val(i)});g.find("[data-html]").each(function(){a(this).html(f[a(this).data("html")]||"")});g.find("[data-val]").each(function(){a(this).val(f[a(this).data("val")]||"")});g.find("[data-src]").each(function(){a(this).attr("src",f[a(this).data("src")]||"")});g.find("[data-href]").each(function(){a(this).attr("href",f[a(this).data("href")]||"")})})};a.ss.__call=a.ss.__call||function(j){var f=a(j.target);var g=f.data(j.type)||f.closest("[data-"+j.type+"]").data(j.type);if(!g){return}var l=g.indexOf(":"),k;if(l>=0){var h=g.substring(0,l);var i=g.substring(l+1);if(h=="trigger"){f.trigger(i,[j.target])}else{k=a.ss.handlers[h];if(k){k.apply(j.target,i.split(","))}}}else{k=a.ss.handlers[g];if(k){k.apply(j.target,[].splice(arguments))}}};a.ss.listenOn="click dblclick change focus blur focusin focusout select keydown keypress keyup hover toggle";a.fn.bindHandlers=function(f){a.extend(a.ss.handlers,f||{});return this.each(function(){var g=a(this);g.off(a.ss.listenOn,a.ss.__call);g.on(a.ss.listenOn,a.ss.__call)})};a.fn.setActiveLinks=function(){var f=window.location.href;return this.each(function(){a(this).filter(function(){return this.href==f}).addClass("active").closest("li").addClass("active")})};a.ss.eventReceivers={};a.ss.reconnectServerEvents=function(i){i=i||{};var h=a.ss.eventSource;var f=new EventSource(i.url||h.url);f.onerror=i.onerror||h.onerror;f.onmessage=i.onmessage||h.onmessage;var g=a.ss.handlers.onReconnect;if(g!=null){g.apply(f,i.errorArgs)}h.close();return a.ss.eventSource=f};a.fn.handleServerEvents=function(g){a.ss.eventSource=this[0];g=g||{};if(g.handlers){a.extend(a.ss.handlers,g.handlers)}function f(k){var q=a.ss.splitOnFirst(k.data," ");var t=q[0];var u=a.ss.splitOnFirst(t,"@");if(u.length>1){k.channel=u[0];t=u[1]}var n=q[1];var o=n?JSON.parse(n):null;q=a.ss.splitOnFirst(t,".");if(q.length<=1){throw"invalid selector format: "+t}var p=q[0],v=q[1].replace(new RegExp("%20","g")," ");if(g.validate&&g.validate(p,v,o,n)===false){return}var w=a.ss.splitOnFirst(v,"$"),i=w[0],j=w[1],h=j&&a(j),l=h&&h[0];if(p=="cmd"){if(i=="onConnect"){a.extend(g,o);if(g.heartbeatUrl){if(g.heartbeat){window.clearInterval(g.heartbeat)}g.heartbeat=window.setInterval(function(){if(a.ss.eventSource.readyState==2){window.clearInterval(g.heartbeat);var r=a.ss.handlers.onStop;if(r!=null){r.apply(a.ss.eventSource)}return}a.ajax({type:"POST",url:g.heartbeatUrl,data:null,dataType:"text",success:function(x){},error:function(){a.ss.reconnectServerEvents({errorArgs:arguments})}})},parseInt(g.heartbeatIntervalMs)||10000)}if(g.unRegisterUrl){a(window).unload(function(){a.post(g.unRegisterUrl,null,function(x){})})}}var m=a.ss.handlers[i];if(m){m.call(l||document.body,o,k)}}else{if(p=="trigger"){a(l||document).trigger(i,[o,k])}else{if(p=="css"){a(h||document.body).css(i,o,k)}else{var s=g.receivers&&g.receivers[p]||a.ss.eventReceivers[p];if(s){if(typeof(s[i])=="function"){s[i].call(l||s[i],o,k)}else{s[i]=o}}}}}if(g.success){g.success(t,o,k)}}a.ss.eventSource.onmessage=f}})(window.jQuery);