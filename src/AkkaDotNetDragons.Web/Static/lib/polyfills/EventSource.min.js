(function(b){if("EventSource" in b){return}var d=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;var a=function(k){var f=this,g=500,h=null,e="";if(!k||typeof k!="string"){throw new SyntaxError("Not enough arguments")}this.URL=k;this.readyState=this.CONNECTING;this._pollTimer=null;this._xhr=null;function j(l){f._pollTimer=setTimeout(function(){i.call(f)},l)}function i(){try{if(f.readyState==f.CLOSED){return}var m=new XMLHttpRequest();m.open("GET",f.URL,true);m.setRequestHeader("Accept","text/event-stream");m.setRequestHeader("Cache-Control","no-cache");m.setRequestHeader("X-Requested-With","XMLHttpRequest");if(h!=null){m.setRequestHeader("Last-Event-ID",h)}e="";m.timeout=50000;m.onreadystatechange=function(){if(this.readyState==3||(this.readyState==4&&this.status==200)){if(f.readyState==f.CONNECTING){f.readyState=f.OPEN;f.dispatchEvent("open",{type:"open"})}var u="";try{u=this.responseText||""}catch(o){}var t=u.substr(e.length).split("\n"),q="message",n=[],r=0,s="";e=u;for(;r<t.length;r++){s=t[r].replace(d,"");if(s.indexOf("event")==0){q=s.replace(/event:?\s*/,"")}else{if(s.indexOf("retry")==0){retry=parseInt(s.replace(/retry:?\s*/,""));if(!isNaN(retry)){g=retry}}else{if(s.indexOf("data")==0){n.push(s.replace(/data:?\s*/,""))}else{if(s.indexOf("id:")==0){h=s.replace(/id:?\s*/,"")}else{if(s.indexOf("id")==0){h=null}else{if(s==""){if(n.length){var p=new c(n.join("\n"),f.url,h);f.dispatchEvent(q,p);n=[];q="message"}}}}}}}}if(this.readyState==4){j(g)}}else{if(f.readyState!==f.CLOSED){if(this.readyState==4){f.readyState=f.CONNECTING;f.dispatchEvent("error",{type:"error"});j(g)}else{if(this.readyState==0){j(g)}else{}}}}};m.send();setTimeout(function(){if(true||m.readyState==3){m.abort()}},m.timeout);f._xhr=m}catch(l){f.dispatchEvent("error",{type:"error",data:l.message})}}i()};a.prototype={close:function(){this.readyState=this.CLOSED;clearInterval(this._pollTimer);this._xhr.abort()},CONNECTING:0,OPEN:1,CLOSED:2,dispatchEvent:function(h,e){var f=this["_"+h+"Handlers"];if(f){for(var g=0;g<f.length;g++){f[g].call(this,e)}}if(this["on"+h]){this["on"+h].call(this,e)}},addEventListener:function(f,e){if(!this["_"+f+"Handlers"]){this["_"+f+"Handlers"]=[]}this["_"+f+"Handlers"].push(e)},removeEventListener:function(h,e){var f=this["_"+h+"Handlers"];if(!f){return}for(var g=f.length-1;g>=0;--g){if(f[g]===e){f.splice(g,1);break}}},onerror:null,onmessage:null,onopen:null,readyState:0,URL:""};var c=function(e,g,f){this.data=e;this.origin=g;this.lastEventId=f||""};c.prototype={data:null,type:"message",lastEventId:"",origin:""};if("module" in b){module.exports=a}b.EventSource=a})(this);